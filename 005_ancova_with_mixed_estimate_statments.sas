data adeff1_;
 set adeff1;
 if trt01pn=1 then trtpn=2;
 if trt01pn=2 then trtpn=3;
 if trt01pn=3 then trtpn=4;
 if trt01pn=4 then trtpn=5;
 if trt01pn=5 then trtpn=1;
 if trt01pn=6 then trtpn=6;
 if trt01pn=7 then trtpn=7;
run;
data adeff2(drop=trt01pn);
 set adeff1_;
 if trt01pn=1 then do; trt01p="LL-10mg"||" (N=&trt1.)";seq_=3;end;
 if trt01pn=2 then do; trt01p="LL-15mg"||" (N=&trt2.)";seq_=4;end;
 if trt01pn=3 then do; trt01p="LL-30mg"||" (N=&trt3.)";seq_=5;end;
 if trt01pn=4 then do; trt01p="LL-50mg"||" (N=&trt4.)";seq_=6;end;
 if trt01pn=5 then do; trt01p="ER 2mg"||" (N=&trt5.)";seq_=2;end;
 if trt01pn=6 then do; trt01p="PBO"||" (N=&trt6.)";seq_=1;end;
 if trt01pn=7 then do; trt01p="Total LL"||" (N=&trt7.)";seq_=7;end;
 valc=strip(put(val,8.));
 seq1=1;
 if agegr1="Age < 65" then seq=1;
 if agegr1="Age >= 65" then seq=2;
run;
data adsl4(drop=trt01pn);
 set adsl3(where=(trt01pn ne 7));
 if trt01pn=1 then trtpn=2;
 if trt01pn=2 then trtpn=3;
 if trt01pn=3 then trtpn=4;
 if trt01pn=4 then trtpn=5;
 if trt01pn=5 then trtpn=1;
 if trt01pn=6 then trtpn=6;
/* if trt01pn=7 then trtpn=7;*/
run;

ods listing close;
ods output Estimates = OutEst LSMeans=OutMeans LSMeanCL=OutCL ;
PROC GLM data=adsl4;
where MITTFL="Y" and PARAMCD="HBA1K48C" and DTYPE in ("LOCF", "  ") and AVISITN=8;
class METBASFL geogr1 BMIGR1 AGEGR1 TRTPN ;
model CHG = METBASFL geogr1 BMIGR1 HBA1CBL AGEGR1 TRTPN AGEGR1*TRTPN/ SOLUTION  CLPARM;
lsmeans AGEGR1*TRTPN/stderr pdiff cl alpha=0.05 ;
 estimate "<65: ER vs PBO" trtpn    1 0 0 0 0 -1 agegr1*trtpn  1 0 0 0 0 -1 0 0 0 0 0 0;
 estimate "<65: LL10 vs PBO" trtpn  0 1 0 0 0 -1 agegr1*trtpn  0 1 0 0 0 -1 0 0 0 0 0 0;
 estimate "<65: LL10 vs ER" trtpn  -1 1 0 0 0 0  agegr1*trtpn -1 1 0 0 0  0 0 0 0 0 0 0;
 estimate "<65: LL15 vs PBO" trtpn  0 0 1 0 0 -1 agegr1*trtpn  0 0 1 0 0 -1 0 0 0 0 0 0;
 estimate "<65: LL15 vs ER" trtpn  -1 0 1 0 0 0  agegr1*trtpn -1 0 1 0 0  0 0 0 0 0 0 0;
 estimate "<65: LL30 vs PBO" trtpn  0 0 0 1 0 -1 agegr1*trtpn  0 0 0 1 0 -1 0 0 0 0 0 0;
 estimate "<65: LL30 vs ER" trtpn  -1 0 0 1 0 0  agegr1*trtpn -1 0 0 1 0  0 0 0 0 0 0 0;
 estimate "<65: LL50 vs PBO" trtpn  0 0 0 0 1 -1 agegr1*trtpn  0 0 0 0 1 -1 0 0 0 0 0 0;
 estimate "<65: LL50 vs ER" trtpn  -1 0 0 0 1 0  agegr1*trtpn -1 0 0 0 1  0 0 0 0 0 0 0;
 estimate "<65: AllLL vs PBO" trtpn 0 1 1 1 1 -4 agegr1*trtpn  0 1 1 1 1 -4 0 0 0 0 0 0 / divisor = 4;     
 estimate "<65: AllLL vs ER" trtpn -4 1 1 1 1 0  agegr1*trtpn -4 1 1 1 1  0 0 0 0 0 0 0 / divisor = 4;

 estimate ">=65: ER vs PBO" trtpn    1 0 0 0 0 -1  agegr1*trtpn 0 0 0 0 0 0  1 0 0 0 0 -1;
 estimate ">=65: LL10 vs PBO" trtpn  0 1 0 0 0 -1  agegr1*trtpn 0 0 0 0 0 0  0 1 0 0 0 -1;
 estimate ">=65: LL10 vs ER" trtpn  -1 1 0 0 0  0  agegr1*trtpn 0 0 0 0 0 0 -1 1 0 0 0  0;
 estimate ">=65: LL15 vs PBO" trtpn  0 0 1 0 0 -1  agegr1*trtpn 0 0 0 0 0 0  0 0 1 0 0 -1;
 estimate ">=65: LL15 vs ER" trtpn  -1 0 1 0 0  0  agegr1*trtpn 0 0 0 0 0 0 -1 0 1 0 0  0;
 estimate ">=65: LL30 vs PBO" trtpn  0 0 0 1 0 -1  agegr1*trtpn 0 0 0 0 0 0  0 0 0 1 0 -1;
 estimate ">=65: LL30 vs ER" trtpn  -1 0 0 1 0  0  agegr1*trtpn 0 0 0 0 0 0 -1 0 0 1 0  0;
 estimate ">=65: LL50 vs PBO" trtpn  0 0 0 0 1 -1  agegr1*trtpn 0 0 0 0 0 0  0 0 0 0 1 -1;
 estimate ">=65: LL50 vs ER" trtpn  -1 0 0 0 1  0  agegr1*trtpn 0 0 0 0 0 0 -1 0 0 0 1  0;
 estimate ">=65: AllLL vs PBO" trtpn 0 1 1 1 1 -4  agegr1*trtpn 0 0 0 0 0 0  0 1 1 1 1 -4 / divisor = 4;
 estimate ">=65: AllLL vs ER" trtpn -4 1 1 1 1  0  agegr1*trtpn  0 0 0 0 0 0 -4 1 1 1 1  0 / divisor = 4;

run;
quit;
